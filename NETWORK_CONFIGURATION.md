# ESP32S3网络配置说明

## 🌐 固定IP配置

ESP32S3设备已配置为使用固定IP地址，避免每次重启后IP地址变化的问题。

### 网络参数
- **固定IP地址**: `192.168.0.194`
- **子网掩码**: `255.255.255.0`
- **网关**: `192.168.0.1`
- **WiFi SSID**: `1500M`
- **WiFi密码**: `23457890`

### 配置代码
```cpp
// 配置固定IP地址
IPAddress local_IP(192, 168, 0, 194);
IPAddress gateway(192, 168, 0, 1);
IPAddress subnet(255, 255, 255, 0);

// 设置固定IP
if (!WiFi.config(local_IP, gateway, subnet)) {
  Serial.println("固定IP配置失败");
}
```

## 🔧 修改IP地址

如果需要修改IP地址，请按以下步骤操作：

### 1. 修改ESP32S3程序
编辑 `esp32s3_audio_server/src/main.cpp` 文件中的IP配置：

```cpp
void connectToWiFi() {
  // 修改这里的IP地址
  IPAddress local_IP(192, 168, 0, 194);  // 改为您需要的IP
  IPAddress gateway(192, 168, 0, 1);     // 改为您的网关
  IPAddress subnet(255, 255, 255, 0);    // 改为您的子网掩码
  
  // ... 其他代码保持不变
}
```

### 2. 修改GUI程序
编辑以下文件中的默认IP地址：
- `src/app.py`
- `src/fixed_app.py`
- `src/working_app.py`
- `test_connection.py`

查找并修改：
```python
# 修改默认IP地址
self.ip_input.setText("192.168.0.194")  # 改为新的IP
def __init__(self, host='192.168.0.194', port=8080):  # 改为新的IP
```

### 3. 重新编译和上传
```bash
cd esp32s3_audio_server
pio run
upload.bat  # 按照提示上传
```

## 🔍 网络诊断

### 检查网络连接
```bash
# 检查ESP32S3是否在线
ping 192.168.0.194

# 检查端口是否开放
telnet 192.168.0.194 8080
```

### 串口监控输出
成功连接后，串口监视器应显示：
```
连接到WiFi: 1500M
.....
WiFi连接成功!
IP地址: 192.168.0.194
网关: 192.168.0.1
子网掩码: 255.255.255.0
I2S麦克风初始化完成
服务器已启动，端口: 8080
```

## 🚨 故障排除

### 常见问题

1. **固定IP配置失败**
   - 检查IP地址是否与网络段匹配
   - 确认网关地址正确
   - 检查IP地址是否被其他设备占用

2. **无法连接到WiFi**
   - 检查WiFi密码是否正确
   - 确认设备在WiFi信号范围内
   - 检查路由器是否允许新设备连接

3. **GUI程序无法连接**
   - 确认ESP32S3已成功连接WiFi
   - 检查防火墙设置
   - 确认端口8080未被占用

### 测试连接
```bash
# 运行连接测试
python test_connection.py

# 检查网络状态
ipconfig
arp -a | findstr "192.168.0.194"
```

## 📋 网络要求

### 路由器设置
- 确保路由器网段为 `192.168.0.x`
- 网关地址为 `192.168.0.1`
- DHCP范围不包含 `192.168.0.194`

### 电脑网络设置
- 电脑应在同一网段 (`192.168.0.x`)
- 能够访问网关 `192.168.0.1`
- 防火墙允许端口8080通信

## 🎯 优势

使用固定IP的优势：
1. **稳定连接**: IP地址不会变化
2. **快速连接**: 无需重新查找设备IP
3. **便于调试**: 可以直接ping和telnet测试
4. **自动化**: 脚本可以使用固定IP自动连接 